// Mixin colors
// A pretty complicated algorithm to create a color palette with n wheels
// - the primaries are: (blue, yellow, red) or (b, y, r)
// - 1. when a next level of colors is generated (ie secondaries) the blue is added to the end of the current colors: (b, y, r, b)
// - 2. looping through this new array and adding consecutive values gives us (b+y, y+r, r+b) which is (g-reen, o-range, v-iolet)
// - for creating the tertiaries we merge the previous two arrays: (b, g, y, o, r, v) and repeat 1.-2.


// The main function
@function color-mix($index) {
  // blue, yellow, red
  // - DO NOT USE html color names; for example green is #080 instead of #0f0
  $blue: #0000ff;
  $yellow: #ffff00;
  $red: #ff0000;

  $colors: ($blue, $yellow, $red);

  @if ($index == 1) {
    @return $colors;
  } @else {
    // Combine all colors into a new array
    $colors: color-mix-all-colors($colors, $index);

    // Generate new colors from the combined array
    @return color-mix-new-colors($colors);
  }
}


// Returns an array of all combined colors from previous steps
// - the recursive function to merge previous color arrays into a new final one which generates the new color wheel
@function color-mix-all-colors($colors, $index) {
  $all_colors: $colors;

  @for $i from 2 to $index {
    $new_colors: color-mix-new-colors(append($all_colors, nth($colors, 1)));
    $all_colors: color-mix-merge-color-arrays($all_colors, $new_colors);
  }

  @return append($all_colors, nth($colors, 1));;
}



// Merging two arrays
// - (b, y, r) + (g, o, v) => (b, g, y, o, r, v)
@function color-mix-merge-color-arrays($array1, $array2) {
  $merge_colors: ();

  @for $i from 1 to length($array1) + 1 {
    $merge_colors: append($merge_colors, nth($array1, $i));
    $merge_colors: append($merge_colors, nth($array2, $i));
  }

  @return $merge_colors;
}


// Returns a new set of colors
// - (b, y, r, b) => (b+y = g, y+r = o, r+b = v)
@function color-mix-new-colors($colors) {
  $new_colors: ();

  @for $i from 1 through length($colors) - 1 {
    $color1: nth($colors, $i);
    $color2: nth($colors, $i + 1);

    // - THERE IS a conflict between the RYB (CMYK) and RGB, so Green must be created by hand
    // - in RGB Blue + Yellow = Gray not Green
    // - http://stackoverflow.com/questions/4255973/calculation-of-a-mixed-color-in-rgb
    @if (($color1 == #0000ff) and ($color2 == #ffff00)) {
      $mixed: #00ff00;
    } @else {
      $mixed: mix($color1, $color2);
    }

    $new_colors: append($new_colors, $mixed);
  }

  @return $new_colors;
}
